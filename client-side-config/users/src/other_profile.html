<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">

    <title>User Profile</title>
    <link rel="stylesheet" href="main.css" />
    <link rel="stylesheet" href="styles.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link
      href="../assets/bootstrap-icons/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link href="../assets//boxicons/css/boxicons.min.css" rel="stylesheet" />
    <!-- Icon Font Stylesheet -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      rel="stylesheet"
    />

    <!-- Google Fonts -->
    <link href="https://fonts.gstatic.com" rel="preconnect" />
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
      rel="stylesheet"
    />

    <!-- Include jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- Include jQuery UI -->
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../frontend.js"></script>
    <script src="../script.js"></script>

    <!-- Tailwind CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- Flowbite CSS CDN -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.css" rel="stylesheet" />
    <!-- Flowbite JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.js"></script>
    <!-- Google Fonts - Poppins -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Poppins', sans-serif;
            overflow-x: hidden;
            overflow-y: hidden;
        }

        .main-frame {
            height: 100vh;
            width: 100vw;
            
          }

        .sticky-top {
            position: sticky;
            top: 0;
            z-index: 1;
        
        }
    
        .text-smaller {
            font-size: 0.8rem;
        }

        .text-sm {
            font-size: 14px;
          }
    
        .text-xs {
            font-size: 12px;
        }
    
        .no-border {
            border: none;
        }
    
        .rounded-xs {
            border-radius: 4px;
        }

        /* Common styles */
        .container {
            margin: 0 auto; /* Center the container horizontally */
            max-width: 100%; /* Allow the container to take the full width */
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            padding-top: 20px;
        }

        .profile-container-wrapper {
            margin-left: auto; /* Push the profile container to the right */
            max-width: calc(100% - 225px); /* Calculate the maximum width */
        }

        .profile-container {
            flex: 0 0 auto;
            width: 300px;
            height: 700px;
            background-color: #f3f4f6;
            padding: 20px;
            border-radius: 8px;
            position: fixed;
            top: 70px;
            bottom: 70px;
            overflow-y: auto;
        }

        /* Container to hold both posts and startup information */
        .post-and-startup-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            overflow-y: auto;
            margin-left: 350px; /* Adjust margin to separate from the profile container */
        }

        /* Adjust the width of the post container */
        .post-and-startup-container > .max-w-md {
            width: 100%;
            max-width: none;
        }

        /* Add gap between Startup and Post */
        .post-and-startup-container > .mt-8 {
            margin-bottom: 40px;
        }

        .profile-container img {
            display: block; /* Center the image */
            margin: 0 auto 20px; /* Add margin for spacing */
        }

        .profile-container h1,
        .profile-container h3,
        .profile-container p,
        .profile-container button {
            margin-top: 10px; /* Add margin between elements */
        }

        .profile-container button:last-child {
            margin-right: 0; /* Remove margin from the last button */
        }


        #startupList {
            margin: 0 auto;
            display: flex; 
            flex-wrap: wrap; 
        }

        /* Carousel styles */
        .carousel {
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            max-width: 100%;
            max-height: 70vh;
            padding: 0 20px;
        }

        .carousel-item {
            flex: 0 0 auto;
            scroll-snap-align: start;
            max-width: calc(100% - 20px);
            max-height: 70vh;
            margin-right: 20px;
        }

        .prev-button,
        .next-button {
            top: 50%;
            transform: translateY(-50%);
            z-index: 1;
            position: sticky;
        }

        .prev-button {
            left: 1rem;
        }

        .next-button {
            right: 1rem;
        }

                
        #description {
            margin-left: 30px;
        }

        /* Adjust specificity */
        .postItem {
            width: 100%;
            max-width: 700px;
            margin: 20px auto;
            padding: 20px;
            box-sizing: border-box;
            background-color: #f3f4f6 !important; /* Add !important to ensure this rule takes precedence */
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Increase the shadow for a more prominent effect */
        }

        /* Optional: Hover effect to make the container interactive */
        .postItem:hover {
            transform: translateY(-2px); /* Add a slight lift effect on hover */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2); /* Increase shadow on hover for depth */
            transition: transform 0.3s, box-shadow 0.3s; /* Add smooth transition for hover effect */
        }

        

        .postItem .authorInfo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .postItem .authorInfo img {
            flex-shrink: 0;
        }

        .postItem .authorInfo p {
            margin: 0;
        }

        #postpic {
            display: block;
            margin: 20px auto; /* Center the image horizontally with some spacing */
            max-width: 100%; /* Ensure the image doesn't overflow */
        }


        #imageModal img {
            max-width: 90%;
            max-height: 90%; 
            z-index: 999;
        }

        /* Container to center the image */
        .relative {
            width: 60%;
            max-width: 300px; /* Set a maximum width for the profile picture */
            margin: auto;
            height: auto;
            position: relative; /* Add position relative for absolute positioning */
        }

        /* Adjust the size of the image */
        #profilePicture {
            width: 100%;
            height: auto;
            max-width: 100%; /* Ensure the image stays within its container */
            border-radius: 50%; /* Ensure the image appears circular */
            position: relative; /* Ensure the image remains within the container */
            z-index: 1; /* Ensure the image is above the gradient ring */
        }

        /* Gradient ring */
        .gradient-ring {
            position: absolute; /* Position the ring relative to the container */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%; /* Ensure the border creates a circular shape */
            background: linear-gradient(45deg, #0C3177, #FCA700); /* Gradient background */
            z-index: 0; /* Ensure the ring is behind the profile picture */
        }


        @media (max-width: 768px) {
            .relative {
                max-width: 200px; /* Adjust the maximum width for smaller screens */
            }
        }




        .invisible {
            display: none;
        }

        .visible {
            display: block;
        }

        .popover {
            position: absolute;
            top: 100%;
            left: 0;
            width: 200px; 
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 8px;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .popover.visible {
            visibility: visible;
            opacity: 1;
        }

        @media (max-width: 768px) {
            .container {
                max-width: 95%;
                padding: 0 10px; 
                flex-direction: column;
            }

            .profile-container {
                width: 100%;
                height: auto;
                margin: 0;
                border-radius: 0;
                position: static;
                padding-bottom: 20px; /* Add padding to the bottom */
            }

            .post-and-startup-container {
                padding: 20px; /* Add padding */
                margin: -15px;
            }


            #startupList {
                margin: 0 -10px; 
            }
        }

        @media (min-width: 1200px) {
            .container {
                max-width: 1100px;
                padding: 0;
            }
            .carousel-item {
                width: 90%;
        }
            
        }

        @media (max-width: 768px) {
            .carousel-item {
                width: calc(100% - 20px); /* Adjust width for smaller screens */
            }
        }

        @media (min-width: 1200px) {
            .carousel-item {
                width: calc(50% - 20px); /* Adjust width for larger screens */
            }
        }
    </style>
</head>
<body class="pt-8">
    <div class="main-frame overflow-y-scroll">
      <!-- Navigation bar -->
      <header
        id="header"
        class="header d-flex align-items-center justify-content-between mb-3 sticky-top"
      >
        <div class="d-flex">
          <i
            class="bi bi-list d-block d-md-none"
            style="font-size: 24px; margin-right: 16px"
            data-bs-toggle="offcanvas"
            data-bs-target="#offcanvasRight"
            aria-controls="offcanvasRight"
          ></i>
          <a href="home.html" class="logo d-flex align-items-center">
            <img src="../img/logo2.png" alt="logo" style="height: 32px" />
          </a>
        </div>

        <nav class="header-nav">
          <ul class="d-flex align-items-center gap-2">
            <li class="nav-item d-block d-lg-none"></li>
            <!-- End Search Icon-->

            <div
              class="border rounded-xs overflow-hidden d-flex align-items-center"
              style="width: 250px"
            >
              <img src="../img/search.svg" height="16px" alt="" class="px-2" />
              <input
                type="text"
                class="no-border py-1 text-sm"
                placeholder="Search here"
                style="height: 32px; outline: none"
              />
            </div>

            <li class="nav-item dropdown">
              <button id="dropdownNotificationButton" data-dropdown-toggle="dropdownNotification" class="relative inline-flex items-center text-sm font-medium text-center text-gray-500 hover:text-gray-900 focus:outline-none dark:hover:text-white dark:text-gray-400" type="button">
                  <img src="../img/notif.svg" height="16px" alt="" />
                  <!-- Optionally, you can add a badge for new notifications -->
                  <!-- <span class="badge rounded-pill bg-primary p-2 ms-2">4</span> -->
              </button>
              <div id="dropdownNotification" class="z-20 hidden w-full max-w-sm bg-white divide-y divide-gray-100 rounded-lg shadow dark:bg-gray-800 dark:divide-gray-700" aria-labelledby="dropdownNotificationButton">
                  <div class="block px-4 py-2 font-medium text-center text-gray-700 rounded-t-lg bg-gray-50 dark:bg-gray-800 dark:text-white">
                      Notifications
                  </div>
                  <div class="divide-y divide-gray-100 dark:divide-gray-700">
                      <!-- Replace this section with your actual notifications -->
                      <!-- Example Notification -->
                      <a href="#" class="flex px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-700">
                          <div class="flex-shrink-0">
                              <img class="rounded-full w-11 h-11" src="/docs/images/people/profile-picture-1.jpg" alt="Jese image">
                              <div class="absolute flex items-center justify-center w-5 h-5 ms-6 -mt-5 bg-blue-600 border border-white rounded-full dark:border-gray-800">
                                  <svg class="w-2 h-2 text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 18 18">
                                      <path d="M1 18h16a1 1 0 0 0 1-1v-6h-4.439a.99.99 0 0 0-.908.6 3.978 3.978 0 0 1-7.306 0 .99.99 0 0 0-.908-.6H0v6a1 1 0 0 0 1 1Z"/>
                                      <path d="M4.439 9a2.99 2.99 0 0 1 2.742 1.8 1.977 1.977 0 0 0 3.638 0A2.99 2.99 0 0 1 13.561 9H17.8L15.977.783A1 1 0 0 0 15 0H3a1 1 0 0 0-.977.783L.2 9h4.239Z"/>
                                  </svg>
                              </div>
                          </div>
                          <div class="w-full ps-3">
                              <div class="text-gray-500 text-sm mb-1.5 dark:text-gray-400">New message from <span class="font-semibold text-gray-900 dark:text-white">Jese Leos</span>: "Hey, what's up? All set for the presentation?"</div>
                              <div class="text-xs text-blue-600 dark:text-blue-500">a few moments ago</div>
                          </div>
                      </a>
                      <!-- End Example Notification -->
                  </div>
                  <a href="#" class="block py-2 text-sm font-medium text-center text-gray-900 rounded-b-lg bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 dark:text-white">
                      <div class="inline-flex items-center ">
                          <svg class="w-4 h-4 me-2 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 14">
                              <path d="M10 0C4.612 0 0 5.336 0 7c0 1.742 3.546 7 10 7 6.454 0 10-5.258 10-7 0-1.664-4.612-7-10-7Zm0 10a3 3 0 1 1 0-6 3 3 0 0 1 0 6Z"/>
                          </svg>
                          View all
                      </div>
                  </a>
              </div>
          </li>
          

            <li class="nav-item dropdown pe-3">
              <a
                class="nav-link nav-profile d-flex align-items-center pe-0"
                href="#"
                data-bs-toggle="dropdown"
              >
                <img
                  src="../img/prof.png"
                  alt="Profile"
                  class="rounded-circle border"
                  style="outline: 1px solid #0a3172"
                  height="32px"
                /> </a
              ><!-- End Profile Iamge Icon -->

              <ul
                class="dropdown-menu dropdown-menu-end dropdown-menu-arrow profile"
              >
                <li class="dropdown-header">
                  <h6>Aedrian Jeao</h6>
                  <span>BatstateU CTI</span>
                </li>
                <li>
                  <hr class="dropdown-divider" />
                </li>

                <li>
                  <a
                    class="dropdown-item d-flex align-items-center"
                    href="profile.html"
                  >
                    <i class="fa-regular fa-user"></i>
                    <span>My Profile</span>
                  </a>
                </li>
                <li>
                  <hr class="dropdown-divider" />
                </li>

                <li>
                  <a
                    class="dropdown-item d-flex align-items-center"
                    href="community.html"
                  >
                    <i class="fa-solid fa-users-rectangle"></i>
                    <span>Community</span>
                  </a>
                </li>
                <li>
                  <hr class="dropdown-divider" />
                </li>

                <li>
                  <a
                    class="dropdown-item d-flex align-items-center"
                    href="messages.html"
                  >
                    <i class="fa-regular fa-message"></i>
                    <span>Messages</span>
                  </a>
                </li>
                <li>
                  <hr class="dropdown-divider" />
                </li>

                <li>
                  <a class="dropdown-item d-flex align-items-center" href="#">
                    <i class="fa-solid fa-gear"></i>
                    <span>Account Settings</span>
                  </a>
                </li>
                <li>
                  <hr class="dropdown-divider" />
                </li>
                <li>
                  <a
                    class="dropdown-item d-flex align-items-center"
                    onclick="logout()"
                  >
                    <i class="fa-solid fa-right-from-bracket"></i>
                    <span>Log Out</span>
                  </a>
                </li>
              </ul>
              <!-- End Profile Dropdown Items -->
            </li>
            <!-- End Profile Nav -->
          </ul>
        </nav>
        <!-- End Icons Navigation -->
      </header>

      <div class="container mx-auto px-4 max-w-3xl flex flex-wrap">

        
        <!-- Image Modal -->
        <div id="imageModal" class="fixed top-0 left-0 w-full h-full bg-black bg-opacity-75 flex items-center justify-center hidden z-50">
            <div class="max-w-full max-h-full overflow-auto">
                <img id="enlargedImage" src="#" alt="Enlarged Profile Picture" class="mx-auto">
            </div>
            <button id="closeModalButton" class="absolute top-4 right-4 text-white text-xl focus:outline-none">&times;</button>
            <!-- Moved the Save button inside the modal -->
            <button id="saveImageButton" class="absolute bottom-4 right-4 bg-white text-black px-4 py-2 rounded shadow-md">Save</button>
        </div>

        <div id="profileContainer" class="profile-container">
            <!-- Profile Picture -->
            <div class="relative">
                <img id="profilePicture" src="https://img.freepik.com/premium-vector/default-avatar-profile-icon-social-media-user-image-gray-avatar-icon-blank-profile-silhouette-vector-illustration_561158-3467.jpg" alt="Profile Picture" class="w-40 h-40 p-1 mx-auto cursor-pointer rounded-full" onclick="openImageModal(event)">
                <div class="absolute inset-0 rounded-full gradient-ring"></div>
            </div>
            <!-- Skeleton Loader for Name -->
            <div id="nameSkeleton" class="animate-pulse bg-gray-300 h-8 rounded mt-4 w-40 mx-auto"></div>
            
            <!-- Skeleton Loader for Username -->
            <div id="usernameSkeleton" class="animate-pulse bg-gray-300 h-6 rounded mt-2 w-24 mx-auto"></div>
            
            <!-- Skeleton Loader for Bio -->
            <div id="bioSkeleton" class="animate-pulse bg-gray-300 h-4 rounded mt-2 w-52 mx-auto"></div>
            
            <!-- Skeleton Loader for Location -->
            <div id="locationSkeleton" class="animate-pulse bg-gray-300 h-4 rounded mt-2 w-28 mx-auto"></div>
        
            <!-- Hidden Content -->
            <h1 id="name" class="text-xl font-semibold text-center mt-2 hidden">Name</h1>
            <span id="usernameContainer" class="relative hidden">
                <h3 id="username" class="text-lg font-bold text-center text-gray-600 mt-1 text-smaller">@Username</h3>
                <div id="usernameTooltip" class="absolute bottom-full left-1/2 transform -translate-x-1/2 bg-gray-900 text-white text-xs px-1 py-1 rounded shadow-md hidden">Click to copy</div>
            </span>
            
            <p id="userBio" class="text-center text-gray-600 mt-2 hidden">User Bio</p>
            <p id="userLocation" class="text-center text-gray-600 mt-2 hidden flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 inline-block align-middle mr-1">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z" />
                </svg>
                <span class="text-gray-600">Location</span>
            </p>
        
            <div class="flex justify-center mt-4"> <!-- Added margin-top and flex to center items -->
                <button id="followButton" class="bg-blue-700 hover:bg-blue-800 text-white font-bold py-2 px-4 rounded mr-4">Follow</button>
                <button id="messageButton" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded">Message</button>
            </div>
        </div>
    <!-- Post and Startup Container -->
    <div class="post-and-startup-container flex flex-col flex-grow">
        <!-- Startup Information -->
        <div class="mt-8">
            <h2 class="text-xl font-bold">Startup Information</h2>
            <div id="startupList" class="mt-4">
                
                <!-- Carousel -->
                <div id="startupCarousel" class="carousel overflow-hidden" data-carousel="slide">
                    <!-- Carousel items -->
                    <!-- JavaScript will dynamically populate these items -->
                </div>
            </div>
        </div>
    
        <!-- Add a gap between Startup and Post -->
        <!-- <div class="mt-8"></div> -->

        <!-- User Posts -->
        <div class="mt-8 max-w-md"> <!-- Adjusted max-w-md -->
            <h2 class="text-xl font-bold">User Posts</h2>
            <div id="postList" class="mt-4 space-y-6">
            <div class="animate-pulse bg-white shadow-md rounded-lg p-6">
                <div class="flex items-center space-x-4">
                    <div class="rounded-full bg-gray-300 h-12 w-12"></div>
                    <div class="flex-1 space-y-4 py-1">
                        <div class="h-4 bg-gray-300 rounded w-3/4"></div>
                        <div class="h-4 bg-gray-300 rounded w-1/2"></div>
                    </div>
                </div>
                <div class="h-4 bg-gray-300 rounded w-full"></div>
                <div class="h-4 bg-gray-300 rounded w-full"></div>
                <div class="h-4 bg-gray-300 rounded w-5/6"></div>
            </div>
            
        </div>
    </div>
</div>
</div>

<script>
    
document.addEventListener("DOMContentLoaded", function () {
    function fetchUserData(userId) {
        const profileUrl = `http://localhost:3000/api/v1/https/profile/${userId}`;
        const accountUrl = `http://localhost:3000/api/v1/https/profile/username/${userId}`;

        // Fetch profile data
        fetch(profileUrl)
            .then(response => response.json())
            .then(profileData => {
                if (profileData.success === 1) {
                    const user = profileData.results[0];
                    document.getElementById("profilePicture").src = user.photo || 'https://img.freepik.com/premium-vector/default-avatar-profile-icon-social-media-user-image-gray-avatar-icon-blank-profile-silhouette-vector-illustration_561158-3467.jpg';
            
                    // Remove hidden class and update content for Name
                    const nameElement = document.getElementById("name");
                    nameElement.textContent = (user.name || "Name").toUpperCase();
                    nameElement.classList.remove("hidden");
            
                    // Remove hidden class and update content for Username
                    const usernameElement = document.getElementById("username");
                    usernameElement.textContent = `@${user.username || "Username"}`;
                    usernameElement.parentNode.classList.remove("hidden");
            
                    // Remove hidden class and update content for Bio
                    const bioElement = document.getElementById("userBio");
                    bioElement.textContent = user.bio || "No User Bio";
                    bioElement.classList.remove("hidden");
            
                    // Remove hidden class and update content for Location
                    const locationElement = document.getElementById("userLocation");
                    locationElement.querySelector("span").textContent = user.location || "No User Location";
                    locationElement.classList.remove("hidden");
            
                    // Remove skeleton loaders
                    document.getElementById("nameSkeleton").remove();
                    document.getElementById("usernameSkeleton").remove();
                    document.getElementById("bioSkeleton").remove();
                    document.getElementById("locationSkeleton").remove();
            
                    // Fetch and update username separately if needed
                    fetch(accountUrl)
                        .then(response => response.json())
                        .then(accountData => {
                            const username = accountData.results[0]?.username || "Username"; 
                            document.getElementById("username").textContent = `@${username}`;
                        })
                        .catch(error => console.error("Error fetching account data:", error));
                } else {
                    console.error("Failed to fetch profile data:", profileData.message);
                }
            })
            .catch(error => console.error("Error fetching profile data:", error));
            
    }

    function fetchUserPosts(userId) {
        const url = `http://localhost:3000/api/v1/https/community/userpost/${userId}`;
        fetch(url)
        .then(response => {
            if (!response.ok) {
                throw new Error("Failed to fetch user posts");
            }
            return response.json();
        })
        .then(data => {
            const postList = document.getElementById("postList");
            postList.innerHTML = ""; // Clear the existing content
            
    
            if (data.success === 1 && data.data && data.data.length > 0) {
                    data.data.forEach((post, index) => {
                        const postItem = document.createElement("div");
                        postItem.classList.add("postItem", "block", "bg-white", "rounded-lg", "shadow-md", "p-6");
    
                        
                        const timestamp = new Date(post.timestamp).toLocaleString('en-US', {
                            year: 'numeric', month: 'short', day: 'numeric', hour: 'numeric', minute: 'numeric'
                        });
    
                        const currentPostContent = `
                        <div class="flex items-center space-x-4">
                            <a href="http://127.0.0.1:5500/client-side-config/users/src/other_profile.html?userId=${userId}">
                                <img src="${post.authorAvatar || 'https://img.freepik.com/premium-vector/default-avatar-profile-icon-social-media-user-image-gray-avatar-icon-blank-profile-silhouette-vector-illustration_561158-3467.jpg'}" alt="Author Avatar" class="w-12 h-12 rounded-full" id="avatar">
                            </a>
                            <div>
                                <a href="http://127.0.0.1:5500/client-side-config/users/src/other_profile.html?userId=${userId}">
                                    <p class="font-semibold">${post.author}</p>
                                </a>
                                <div class="text-gray-500">${timestamp}</div>
                            </div>
                        </div>
                        <a href="http://127.0.0.1:5500/client-side-config/users/src/other_profile.html?postId=${post.id}">
                            <h3 class="text-xl font-bold mt-2 text-blue-600 hover:underline">${post.title}</h3>
                        </a>
                        <a href="http://127.0.0.1:5500/client-side-config/users/src/other_profile.html?postId=${post.id}">
                            <p class="mt-4">${post.content}</p>
                        </a>
                        ${post.image ? `<a href="#" onclick="postModal(${post.id}); return false;"><img src="${post.image}" class="mt-4 rounded-lg max-w-full h-auto" id="postpic"></a>` : ""}
                        <div class="flex items-center justify-between mt-4">
                            <!-- Like button and popover -->
                            <div class="relative group">
                                <button class="text-blue-500 hover:text-blue-700 mr-2 like-button">Like (${post.likeCount ?? 0})</button>
                                ${post.likeCount > 0 && post.likers ?
                                    `<div class="popover" data-popover-like id="popover-user-profile-like-${post.id}">
                                        <ul class="divide-y divide-gray-200">
                                            ${post.likers.split(',').map(liker => {
                                                const [likerName] = liker.split(':');
                                                return `
                                                    <li class="flex items-center py-2">
                                                        <span class="ml-2">${likerName || 'Default Name'}</span>
                                                    </li>
                                                `;
                                            }).join('')}
                                        </ul>
                                    </div>` : ''}
                            </div>
                            
                            <!-- Dislike button and popover -->
                            <div class="relative group">
                                <button class="text-red-500 hover:text-red-700 mr-2 dislike-button">Dislike (${post.dislikeCount ?? 0})</button>
                                ${post.dislikeCount > 0 && post.dislikers ?
                                    `<div class="popover" data-popover-dislike id="popover-user-profile-dislike-${post.id}">
                                        <ul class="divide-y divide-gray-200">
                                            ${post.dislikers.split(',').map(disliker => {
                                                const [dislikerName] = disliker.split(':');
                                                return `
                                                    <li class="flex items-center py-2">
                                                        <span class="ml-2">${dislikerName || 'Default Name'}</span>
                                                    </li>
                                                `;
                                            }).join('')}
                                        </ul>
                                    </div>` : ''}
                            </div>
                            
                            <button class="text-gray-500 hover:text-gray-700 comment-button">Comment (${post.commentCount ?? 0})</button>
                            <button class="text-gray-500 hover:text-gray-700 share-button" data-url="${post.url}">Share</button>
                        </div>
                    `;
                    
                    postItem.innerHTML = currentPostContent;
                    
                    
    
                        postList.appendChild(postItem);
    
                        const likeButton = postItem.querySelector('.like-button');
                        const dislikeButton = postItem.querySelector('.dislike-button');
    
                        likeButton.addEventListener('mouseenter', () => {
                            const likePopover = postItem.querySelector(`#popover-user-profile-like-${post.id}`);
                            if (likePopover) {
                                likePopover.classList.add('visible');
                            }
                        });
    
                        likeButton.addEventListener('mouseleave', () => {
                            const likePopover = postItem.querySelector(`#popover-user-profile-like-${post.id}`);
                            if (likePopover) {
                                likePopover.classList.remove('visible');
                            }
                        });
    
                        dislikeButton.addEventListener('mouseenter', () => {
                            const dislikePopover = postItem.querySelector(`#popover-user-profile-dislike-${post.id}`);
                            if (dislikePopover) {
                                dislikePopover.classList.add('visible');
                            }
                        });
    
                        dislikeButton.addEventListener('mouseleave', () => {
                            const dislikePopover = postItem.querySelector(`#popover-user-profile-dislike-${post.id}`);
                            if (dislikePopover) {
                                dislikePopover.classList.remove('visible');
                            }
                        });
    
                       
                        if (index === data.data.length - 1) {
                            const lastPostMessage = document.createElement("p");
                            lastPostMessage.textContent = "You've reached the last post.";
                            lastPostMessage.classList.add("text-gray-500", "text-center", "mt-4"); 
                            postList.appendChild(lastPostMessage);
                        }
                    });
    
                } else {
                    const noPostsMessage = document.createElement("p");
                    noPostsMessage.textContent = "No posts available";
                    postList.appendChild(noPostsMessage);
                }
            })
            .catch(error => {
                console.error("Error fetching user posts:", error);
                const postList = document.getElementById("postList");
                postList.innerHTML = "Failed to fetch user posts.";
            });
        }       
    
    
        function fetchUserStartup(userId) {
            const url = `http://localhost:3000/api/v1/https/startup-info/startup/${userId}`;
            fetch(url)
            .then(response => {
                if (!response.ok) {
                    throw new Error("Failed to fetch startup data");
                }
                return response.json();
            })
            .then(data => {
                const startupList = document.getElementById("startupList");
        
                if (data.success === 1 && data.results && data.results.length > 0) {
                    if (data.results.length === 1) {
                        const startup = data.results[0];
                        startupList.innerHTML = `
                        <div class="bg-white border border-gray-200 rounded-lg shadow-lg p-6">
                            <h5 class="mb-2 text-2xl font-bold tracking-tight text-gray-900">${startup.title}</h5>
                            <p class="mb-3 font-normal text-gray-700">${startup.description}</p>
                            <a href="${startup.link}" target="_blank" class="inline-flex items-center px-3 py-2 text-sm font-medium text-center text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                                Read more
                                <svg class="rtl:rotate-180 w-3.5 h-3.5 ms-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 10">
                                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 5h12m0 0L9 1m4 4L9 9"/>
                                </svg>
                            </a>
                        </div>
                    `;
                    
                    } else {
                        displayStartupCarousel(data.results);
                    }
                } else {
                    const noStartupMessage = document.createElement("p");
                    noStartupMessage.textContent = "No startup information available";
                    startupList.innerHTML = ""; // Clear previous content
                    startupList.appendChild(noStartupMessage);
                }
            })
            .catch(error => {
                console.error("Error fetching user startup data:", error);
                const startupList = document.getElementById("startupList");
                startupList.innerHTML = "Failed to fetch startup information.";
            });
        }
        
        function displayStartupCarousel(startups) {
            const carousel = document.getElementById("startupCarousel");
            carousel.classList.add("carousel");
            carousel.innerHTML = ""; 
        
            startups.forEach(startup => {
                const carouselItem = document.createElement("div");
                carouselItem.classList.add("carousel-item", "relative");
                carouselItem.innerHTML = `
                <div class="bg-white border border-gray-200 rounded-lg shadow-lg p-6 relative">
                    <h5 class="mb-2 text-2xl font-bold tracking-tight text-gray-900">${startup.title}</h5>
                    <p class="mb-3 font-normal text-gray-700" id="description">${startup.description}</p>
                    
                    <a href="${startup.link}" target="_blank" class="inline-flex items-center px-3 py-2 text-sm font-medium text-center text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                        Read more
                        <svg class="rtl:rotate-180 w-3.5 h-3.5 ms-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 10">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 5h12m0 0L9 1m4 4L9 9"/>
                        </svg>
                    </a>
                    
                    <button class="absolute left-0 bg-white rounded-full p-2 shadow-md text-blue-700 hover:text-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-600 prev-button">&lt;</button>
                    <button class="absolute right-0 bg-white rounded-full p-2 shadow-md text-blue-700 hover:text-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-600 next-button">&gt;</button>
                </div>
            `;
            
                carousel.appendChild(carouselItem);
            });
        
            const carouselItems = document.querySelectorAll(".carousel-item");
            const totalItems = carouselItems.length;
            let currentIndex = 0;
        
            function scrollCarousel(direction) {
                const itemWidth = carouselItems[0].offsetWidth;
                const scrollAmount = itemWidth * direction;
        
                carousel.scrollBy({
                    left: scrollAmount,
                    behavior: "smooth"
                });
        
                currentIndex += direction;
        
                if (currentIndex >= totalItems) {
                    currentIndex = 0;
                } else if (currentIndex < 0) {
                    currentIndex = totalItems - 1;
                }
            }
        
            carousel.addEventListener("click", event => {
                const target = event.target;
        
                if (target.classList.contains("prev-button")) {
                    scrollCarousel(-1);
                } else if (target.classList.contains("next-button")) {
                    scrollCarousel(1);
                }
            });
        }
        
    
    function followUser() {
        // follow user logic...
    }

    const urlParams = new URLSearchParams(window.location.search);
    const userId = urlParams.get("userId");
    if (userId) {
        fetchUserData(userId);
        fetchUserPosts(userId);
        fetchUserStartup(userId);
    } else {
        console.error("User ID not found in URL parameters.");
    }

    document.getElementById("followButton").addEventListener("click", function () {
        followUser();
    });

    navBar();

    
});
function openImageModal(event) {
    const profilePictureSrc = event.target.src;
    const enlargedImage = document.getElementById("enlargedImage");
    enlargedImage.src = profilePictureSrc;
    document.getElementById("imageModal").classList.remove("hidden");
}

document.getElementById("closeModalButton").addEventListener("click", function() {
    document.getElementById("imageModal").classList.add("hidden");
});

document.getElementById("saveImageButton").addEventListener("click", function() {
    const enlargedImageUrl = document.getElementById("enlargedImage").src;
    const a = document.createElement('a');
    a.href = enlargedImageUrl;
    a.download = 'profile_picture.jpg';
    a.click();
});

function copyUsername() {
    const usernameText = document.getElementById("username").textContent;
    const usernameWithoutAt = usernameText.replace("@", ""); 
    navigator.clipboard.writeText(usernameWithoutAt);
    
    const tooltip = document.getElementById("usernameTooltip");
    tooltip.textContent = "Copied!";
    tooltip.classList.remove("hidden");
    setTimeout(() => {
        tooltip.classList.add("hidden");
    }, 1000);
}

const usernameContainer = document.getElementById("usernameContainer");
usernameContainer.addEventListener("mouseover", () => {
    const tooltip = document.getElementById("usernameTooltip");
    tooltip.classList.remove("hidden");
    
});
usernameContainer.addEventListener("mouseout", () => {
    const tooltip = document.getElementById("usernameTooltip");
    tooltip.classList.add("hidden");
});
usernameContainer.addEventListener("click", () => {
    copyUsername();
});

document.getElementById("messageButton").addEventListener("click", function() {
    
    const userId = "123"; 
    
    
    window.location.href = `http://localhost:3000/api/v1/https/message/messages`;
});
</script>
</body>
</html>
